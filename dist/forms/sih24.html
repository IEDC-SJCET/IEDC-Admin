<div class="w-100 min-vh-100 d-flex flex-column justify-content-start align-items-center gap-3 p-3">
    <div id="formHead">
        <div class="card shadow-lg container p-0" style="max-width: 500px;">
            <img src="./img/bannersih24.png" alt="" class="card-img-top">
            <div class="card-header d-flex justify-content-between">
                <h2 class="fs-2 fw-bolder">SIH'24</h2>
                <a id="backBTN" class="greencolor fs-4"><i class="bi bi-check-circle-fill"></i></a>
            </div>
            <div class="card-body">
                <div class="d-flex gap-1"><i class="bi bi-person-fill greencolor"></i>
                    x<span id="noRes"></span>
                </div>
            </div>
            <div class="d-flex gap-1 card-footer">
                <button id="refreshBTN" class="btn btn-dark rounded">
                    Refresh <i class="bi bi-arrow-clockwise"></i>
                </button>
                <button id="" onclick="copytable('firetable')" class="btn btn-dark rounded">
                    Copy Table <i class="bi bi-clipboard"></i>
                </button>
                <!-- New Download CSV Button -->
                <button id="downloadCSV" class="btn btn-dark rounded">
                    Download CSV <i class="bi bi-file-earmark-spreadsheet"></i>
                </button>
            </div>
        </div>
    </div>
    <div id="formContainer" class="card shadow-lg d-flex flex-column gap-3 overflow-auto w-100 mb-3">
        <table id="firetable">
            <thead>
                <tr>
                    <th></th>
                    <th class="text-center CEO" colspan="8">Team Leader</th>
                    <th class="text-center CTO" colspan="4">Member 2</th>
                    <th class="text-center CMO" colspan="4">Member 3</th>
                    <th class="text-center CEO" colspan="4">Member 4</th>
                    <th class="text-center CTO" colspan="4">Member 5</th>
                    <th class="text-center CMO" colspan="4">Member 6</th>
                    <th class="text-start CEO" colspan="4">Team</th>
                    <th class="text-start" colspan="8">Submission Docs</th>
                </tr>
                <tr>
                    <th style="min-width: 200px;">Time</th>
                    <th style="min-width: 200px;">Name</th>
                    <th>Branch</th>
                    <th>Year</th>
                    <th>Email</th>
                    <th>Phone</th>
                    <th>LinkedIn</th>
                    <th>Github</th>
                    <th>Food Preference</th>

                    <th>Name</th>
                    <th>Branch</th>
                    <th>Year</th>
                    <th>Food Preference</th>

                    <th>Name</th>
                    <th>Branch</th>
                    <th>Year</th>
                    <th>Food Preference</th>

                    <th>Name</th>
                    <th>Branch</th>
                    <th>Year</th>
                    <th>Food Preference</th>

                    <th>Name</th>
                    <th>Branch</th>
                    <th>Year</th>
                    <th>Food Preference</th>

                    <th>Name</th>
                    <th>Branch</th>
                    <th>Year</th>
                    <th>Food Preference</th>

                    <th>id</th>
                    <th>Team Name</th>
                    <th>Category </th>
                    <th>Total Members</th>

                    <th style="min-width: 100px;">Describe Idea</th>
                    <th>Title</th>
                    <th>PS Code</th>
                    <th>Dependency</th>
                    <th>Tech Stack</th>
                    <th>Theme</th>
                    <th>Use Case</th>
                    <th>Document</th>
                </tr>
            </thead>

            <tbody id="responcesTableBody"></tbody>
        </table>
    </div>
</div>

<script type="text/javascript">
    function copytable(el) {
        var urlField = document.getElementById(el);
        var range = document.createRange();
        range.selectNode(urlField);
        window.getSelection().addRange(range);
        document.execCommand('copy');
    }

    function downloadCSV() {
        const table = document.getElementById("firetable");
        let csvContent = "";

        // Extract table headers
        const headerRows = table.querySelectorAll("thead tr");
        headerRows.forEach((row, rowIndex) => {
            const headers = Array.from(row.querySelectorAll("th"))
                .map((th) => {
                    // Handle colspan
                    const colspan = th.getAttribute("colspan") || 1;
                    return Array.from({ length: colspan }, () => th.innerText);
                })
                .flat();
            csvContent += headers.join(",") + "\n";
        });

        // Extract table rows
        const rows = table.querySelectorAll("tbody tr");
        rows.forEach((row) => {
            const cells = Array.from(row.querySelectorAll("td")).map(
                (td) => td.innerText
            );
            csvContent += cells.join(",") + "\n";
        });

        // Create a Blob from the CSV content
        const blob = new Blob([csvContent], { type: "text/csv" });
        const url = URL.createObjectURL(blob);

        // Create a temporary link element and trigger the download
        const link = document.createElement("a");
        link.href = url;
        link.download = "table-data.csv";
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }

    document.getElementById("downloadCSV").addEventListener("click", downloadCSV);
</script>

<!-- Add your JavaScript files here if any -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>